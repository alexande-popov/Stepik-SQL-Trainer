Исходная таблица
```
+---------+-----------------------+------------------+--------+--------+
| book_id | title                 | author           | price  | amount |
+---------+-----------------------+------------------+--------+--------+
| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |
| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |
| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |
| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |
| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |
| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |
+---------+-----------------------+------------------+--------+--------+
```
## Уникальные элементы столбца `DISTINCT`, `GROUP BY`
Для отображения уникальных элементом столбца используется ключевое слово `DISTINCT` (от *англ*. особый, отдельный, отчетливый, определенный). Размещается сразу после `SELECT`.

Можно использовть и оператор `GROUP BY`. `GROUP BY` группирует данные при выборке, имеющие одинаковые значения в некотором столбце.

```SQL
SELECT DISTINCT author FROM book;
```
Или аналогично через `GROUP BY`:
```SQL
SELECT  author FROM book
GROUP BY author;
```

## Групповые (агрегатные) функции
* `SUM()`
* `COUNT()`
* `MIN()`
* `MAX()`
* `AVG()`

При группировке выбранный столбец должен быть включен и в `SELECT`, и в `GROUP BY`, естественно.

**Пример**

Посчитать, сколько экземпляров книг каждого автора хранится на складе, сколько всего книг (названий) каждого автора.

**Замечание**: Для аргументов функции `COUNT()`, в скобках можно указать ЛЮБОЙ столбец из группы, если группа не содержит ПУСТЫХ значений.
В качестве имен столбцов появились вычисляемые выражения, поэтому лучше вводить псевдонимы.
```SQL
SELECT author, sum(amount), count(amount)
FROM book
GROUP BY author;
```
```
+------------------+-------------+---------------+
| author           | sum(amount) | count(amount) |
+------------------+-------------+---------------+
| Булгаков М.А.    | 8           | 2             |
| Достоевский Ф.М. | 23          | 3             |
| Есенин С.А.      | 15          | 1             |
+------------------+-------------+---------------+
```
**Пример** работы `COUNT()` с ПУСТЫМИ значениями.
```SQL
INSERT INTO book (title, author, price, amount) VALUES ('Черный человек','Есенин С.А.', Null, Null);
```
Имеем таблицу:
```
+---------+-----------------------+------------------+--------+--------+
| book_id | title                 | author           | price  | amount |
+---------+-----------------------+------------------+--------+--------+
| 1       | Мастер и Маргарита    | Булгаков М.А.    | 670.99 | 3      |
| 2       | Белая гвардия         | Булгаков М.А.    | 540.50 | 5      |
| 3       | Идиот                 | Достоевский Ф.М. | 460.00 | 10     |
| 4       | Братья Карамазовы     | Достоевский Ф.М. | 799.01 | 3      |
| 5       | Игрок                 | Достоевский Ф.М. | 480.50 | 10     |
| 6       | Стихотворения и поэмы | Есенин С.А.      | 650.00 | 15     |
| 7       | Черный человек        | Есенин С.А.      | Null   | Null   |
+---------+-----------------------+------------------+--------+--------+
```
```SQL
SELECT author, COUNT(author), COUNT(amount), COUNT(*)
FROM book
GROUP BY author;
```
```
+------------------+---------------+---------------+----------+
| author           | COUNT(author) | COUNT(amount) | COUNT(*) |
+------------------+---------------+---------------+----------+
| Булгаков М.А.    | 2             | 2             | 2        |
| Достоевский Ф.М. | 3             | 3             | 3        |
| Есенин С.А.      | 2             | 1             | 2        |
+------------------+---------------+---------------+----------+
```
### Задание
Вывести фамилию и инициалы автора, минимальную, максимальную и среднюю цену книг каждого автора . Вычисляемые столбцы назвать `Минимальная_цена`, `Максимальная_цена` и `Средняя_цена` соответственно.
```SQL
SELECT author,
  MIN(price) AS Минимальная_цена,
  MAX(price) AS Максимальная_цена,
  AVG(price) AS Средняя_цена
FROM book
GROUP BY author;
```
